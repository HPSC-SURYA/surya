# Remove any data files from previous runs
rm -f diffrot.dat psi.dat final.dat run.dat ber.dat butbot.dat rad.dat

# If there is an existing input.txt file, move it to some other name
# so the script can move in its own copy
if [ -e "input.txt" ]
then
  mv input.txt backup.input.txt
fi

# Copy in options file that does a ten thousand timesteps
cp tenThousandTimestepTest/input.txt .

# Run program for a ten thousand timesteps
./surya

# Restore the options file to the original one
if [ -e "backup.input.txt" ]
then
  rm -f input.txt
  mv backup.input.txt input.txt
fi

# Compare each of the output files to the master output files
anyDifferences=0
diff diffrot.dat tenThousandTimestepTest/diffrot.dat > /dev/null
if [ $? != 0 ]
then
  echo "The diffrot.dat file is different."
  anyDifferences=1
fi
diff psi.dat tenThousandTimestepTest/psi.dat > /dev/null
if [ $? != 0 ]
then
  echo "The psi.dat file is different."
  anyDifferences=1
fi
diff final.dat tenThousandTimestepTest/final.dat > /dev/null
if [ $? != 0 ]
then
  echo "The final.dat file is different."
  anyDifferences=1
fi
diff run.dat tenThousandTimestepTest/run.dat > /dev/null
if [ $? != 0 ]
then
  echo "The run.dat file is different."
  anyDifferences=1
fi
diff ber.dat tenThousandTimestepTest/ber.dat > /dev/null
if [ $? != 0 ]
then
  echo "The ber.dat file is different."
  anyDifferences=1
fi
diff rad.dat tenThousandTimestepTest/rad.dat > /dev/null
if [ $? != 0 ]
then
  echo "The rad.dat file is different."
  anyDifferences=1
fi
diff butbot.dat tenThousandTimestepTest/butbot.dat > /dev/null
if [ $? != 0 ]
then
  echo "The butbot.dat file is different."
  anyDifferences=1
fi

# If no files are different, write out a message that the test was successful
if [ $anyDifferences -eq 0 ]
then
  echo "The program's output is correct for the case of a ten thousand timesteps."
else
  echo "##### ERROR #####"
  echo "At least one of the output files from the surya program was not correct."
fi
